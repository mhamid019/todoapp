<!DOCTYPE html>
<html lang="en">
<head>
    <title>To do app</title>
    <meta charset="utf-8">
    <meta name="description" content="web develoment practice">
    <meta name="keywords" content="HTML, CSS, JavaScript">
    <meta name="web-dev-lover" content="John Doe">
    <meta  name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    *, ::before, ::after {margin: 0; box-sizing: border-box;}
    html {font: 15px system-ui, sans-serif;}
    body {background: rgb(41, 33, 33); color: #ddd;}

    .container {
        max-width: 400px;
        margin: auto;
        position: relative;
    }

    .container input {
        width: 100%;
        display: block;
        margin: auto;
        padding: 8px 8px;
        border: none;
        outline: none;
        background: inherit;
        border-bottom: 2px solid rgb(131, 134, 103);
        font-size: 1.1rem;
        position: sticky;
        caret-color: rgb(212, 212, 122);
        color: #ddd;
    }

    .container input::placeholder {color: rgb(136, 136, 139);}

    main {
        box-shadow: 0 0 20px #222;
        max-height: 300px;
        margin: 1rem auto;
        border-radius: 0 0 4px 4px;
        padding: 1rem 0;
        position: relative;
        overflow-x: hidden;
        overflow-y: auto;
    }

    main::-webkit-scrollbar {width: 6px;}

    main::-webkit-scrollbar-thumb {
        background: #484141;
        border-radius: 10px;
        transition: 0.4s;
    }

    main::-webkit-scrollbar-thumb:hover {background: #776363;}

    main ul {list-style: none; padding: 0;}
    main ul li {
        background: #211;
        color: #ddd;
        padding: 8px 10px;
        border-radius: 4px;
        margin-top: 10px;
        position: relative;
        cursor: pointer;
    }

    li .remove-list {
        color: rgb(175, 175, 51);
        position: absolute;
        right: 10px;
        top: 5px;
        font-size: 1.2rem;
        font-weight: bold;
        user-select: none;
    }

    main li.done {text-decoration: line-through; background: #312e2e; color: rgb(132, 168, 132);}

    .container .err-msg {
        position: absolute;
        top: -20px;
        left: 0;
        font-size: 13px;
        display: none;
        animation: err 1s ease-in 3;
        color: #f2f5e6;
        z-index: 9999;
    }

    @keyframes err {to {color: rgb(252, 0, 0)}}

    @media screen and (max-width: 400px) {
        main {max-width: 96%; min-height: 350px;}
    }


    @media screen and (max-width: 468px) {

        main::-webkit-scrollbar {width: 4px;}

        main::-webkit-scrollbar-thumb {
            background: #484141;
            border-radius: 10px;
        }
        .container input, .container main {width: 92%;}
    }
</style>

<body>



    <h2 style="text-align: center; margin: 1.5rem 0; color: #d0b2b2;">To Do App</h2>
 
    <div class="container">
        <input type="text" placeholder="Write and press enter" autofocus>
        <span class="err-msg">Please add your list</span>
        <main>
            <ul id="list">

            </ul>
        </main>
    </div>


                                                <!-- script -->

                                 

<script>

const todoBox = document.querySelector(".container input");
const list = document.querySelector("main #list");
const errorMsg = document.querySelector(".err-msg");

// load old todos from localStoragen
window.addEventListener("DOMContentLoaded", loadTodos);

todoBox.addEventListener("keypress", function(e) {
    if(e.key === "Enter") {
        addItem(this.value);
        this.value = "";
    }
});

todoBox.addEventListener("input", function() {
    errorMsg.style.display = "none";
});

function addItem(text, save = true) {
    if(!text.trim()) {
        errorMsg.style.display = "block";
        return;        
    }
    const item = document.createElement("li");
    item.innerHTML = `${text} <span class="remove-list">&times;</span>`;
    list.appendChild(item);

    // toggle done class
    item.addEventListener("click", function(e) {
        if(e.target.classList.contains("remove-list")) return;
        this.classList.toggle("done");
        updateStorage();
    });

    item.querySelector("span").addEventListener("click", function(e) {
        e.stopPropagation();
        item.remove();
        updateStorage();
    });

    if(save) updateStorage();
}

function updateStorage() {
    const allItems = [];
    // console.log(allItems);
    
    list.querySelectorAll("li").forEach(li => {
        allItems.push({
            text: li.childNodes[0].textContent.trim(),
            done: li.classList.contains("done")
        });
    });
    localStorage.setItem("todos", JSON.stringify(allItems));
}

function loadTodos(){
    const saved = JSON.parse(localStorage.getItem("todos")) || [];
    saved.forEach(todo => addItem(todo.text, false));

    const allList = list.querySelectorAll("li");
    saved.forEach((todo, i)=> {
        if(todo.done) allList[i].classList.add("done");
    });
}


</script>                                                

</body>
</html>


